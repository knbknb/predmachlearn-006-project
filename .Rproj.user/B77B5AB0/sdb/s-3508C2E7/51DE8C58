{
    "contents" : "# Reproducible Research: \n# Peer Assessment 1\n\nKnut Behrends  \nknb@gfz-potsdam.de  \nJuly 2014  \n\nThe instructions for this  assignment can be found on this page: \n[https://github.com/rdpeng/RepData_PeerAssessment1](https://github.com/rdpeng/RepData_PeerAssessment1).  \nPlease read this first for context and details.\n\n\nCalculated with R 3.1.0, for details about the software used, see bottom of report.\n\n\n## Loading and preprocessing the data\n\n- Set working directory, \n- Read in data, ignoring cases with \"NA\" values\n- Converting the \"date\" column to Date datatype\n\n```{r}\n\nlibrary(lubridate)\nlibrary(plyr)\n\nsetwd(\"/home/knut/Documents/coursera/datascience/5-reprod-research/RepData_PeerAssessment1\")\n\nsource(\"makePlot.R\")\n\nact <- read.csv(\"activity.csv\", header=TRUE, na.strings=c(\"NA\"))\n\n```\n\n These are the number of NA values in each column:\n\n```{r}\ncolSums(is.na(act));\n```\n\nPreparing a new data frame, all rows with NA values removed:\n```{r}\n\nact$date <- as.Date(act$date)\nactf <- act[which(act$steps >= 0),]\n\n\n\n```\n\n\n### The total number of steps per each day can be calculated as follows:\n```{r}\n\nactfagg <- ddply(actf, .(date), summarize,  sumsteps = round(sum(steps), 0))\nhead(actfagg, 10)\n\n```\n### The mean and median total number of steps taken per day are very similar.\nMean:\n```{r}\n\nmean_steps_per_day <- round(mean(actfagg$sumsteps),0); mean_steps_per_day\n\n```\n\nMedian:\n```{r}\nmedian_steps_per_day <<- round(median(actfagg$sumsteps),0); median_steps_per_day\n```\n### Steps per day visualised as a histogram:\n\n\n```{r hist}\nstrtit <- \"Daily physical activity of an anonymous person in Oct-Nov 2012\"\nhist(actfagg$sumsteps,  breaks=20, xlab=\"Number of steps walked per day\", ylab=\"Frequency of days\", main=strtit)\n\nabline(v= mean_steps_per_day, lwd =2, col=\"blue\")\nabline(v= median_steps_per_day, lwd =1, col=\"red\")\n```\n\nIn the plot above, the mean value of n = `r mean_steps_per_day` is shown as a blue line, the median as a red line.\n\n\n### The mean of steps per interval-of-the-day can be calculated as follows.\nWe assume that there are the same number of 5-Minute-Intervals per measurement day. There are \n```{r}\nnintv <- length(unique(actf$interval)); nintv\n```\n\nintervals per day. \nAfter summing up all the steps taken during each interval, we have to normalize each sum by this value.\n```{r}\n\nactfagg3 <- ddply(actf, .(interval), summarize,  meansteps = round(sum(steps)/ nintv, 0))\n\n\n```\n \n\n\n\n```{r echo=FALSE,return=FALSE}\n# Some sample data for ddays where the average of steps taken is above 10:\nhead(actfagg3[which(actfagg3$meansteps > 10),], 10)\n```\n\n### This is the interval of the day during which, on average, user made the highest number of steps:\n```{r}\n\nintvmax <- actfagg3[which.max(actfagg3$meansteps),]; intvmax\n\n```\n\n\n\n\n## Are there differences in activity patterns between weekdays and weekends?\n\nThis can be visualized with a time series plot.\n\n\n### Plotting daily averages of steps made, using filtered data:\n\n```{r}\n\nnintv <- length(unique(actf$interval));\n\n\ndays.weekend <- actf[(wday(actf$date) %in% c(6,1)),];\nnweekenddays <- nrow(days.weekend)/nintv;\non.weekend <-  ddply(days.weekend, .(interval), summarize,  mean_weekend_steps = round(sum(steps)/nweekenddays, 0)) ;\n\ndays.workweek <- actf[! (wday(actf$date) %in% c(6,1)),]\nnworkdays <- nrow(days.workweek)/nintv\non.workday <- ddply(days.workweek, .(interval), summarize,  mean_workday_steps = round((sum(steps)/nworkdays), 0))\n\n\n        \nmakePlot(on.weekend, on.workday)\n\n```\n\nThe plots show that the user started to move around later during the day on weekends, compared to his/her activity during the workweek.\n\n### The maximum of the daily averages of the 5-minute intervals\nThe maximum of the daily averages of the 5-minute intervals is interval n = `r on.weekend[which.max(on.weekend$mean_weekend_steps),]$interval` ,  `r max(on.weekend$mean_weekend_steps, on.workday$mean_workday_steps )`.\n\n\n## Coping with missing data\n\n\nTo this end, we'll substitute NA values with the value for the mean steps per day (`r sprintf(\"%0.0f\", mean_steps_per_day)`), determined above.  \n\n```{r}\nbad <- is.na(act$steps)\nact[bad, \"steps\"] <- mean_steps_per_day/length(unique(act$date))\n\nactagg <- ddply(act, .(date), summarize,  sumsteps = round(sum(steps), 0))\n\n\n\nstrtit <- paste0(\"Daily physical activity of an anonymous person in Oct-Nov 2012\", \"\\n\", \" NAs substituted with daily averages\")\nhist(actagg$sumsteps,  breaks=20, xlab=\"Number of steps walked per day\", ylab=\"Frequency of days\", main=strtit)\n```\n\nThe plot shows that there the newly assigned values produce asingle new bin to the far right of the histogram,  for all thos, however the shape of the histogram is not distorted much, and mean and median are still nearly unchanged.\nNow we're plotting daily averages of steps made, using unfiltered data.  \n\n\n```{r}\n\nnintv <- length(unique(act$interval));\n\n\ndays.weekend <- act[(wday(act$date) %in% c(6,1)),];\nnweekenddays <- nrow(days.weekend)/nintv;\non.weekend <-  ddply(days.weekend, .(interval), summarize,  mean_weekend_steps = round(sum(steps)/nweekenddays, 0)) ;\n\ndays.workweek <- act[! (wday(act$date) %in% c(6,1)),]\nnworkdays <- nrow(days.workweek)/nintv\non.workday <- ddply(days.workweek, .(interval), summarize,  mean_workday_steps = round((sum(steps)/nworkdays), 0))\n\nmakePlot(on.weekend, on.workday,\"missing data replaced with daily median value\")\n\n```\n\n### R Session Info:\n\n```{r}\nsessionInfo()\n```",
    "created" : 1414009290502.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2270346681",
    "id" : "51DE8C58",
    "lastKnownWriteTime" : 1405973309,
    "path" : "~/Documents/coursera/datascience/5-reprod-research/RepData_PeerAssessment1/PA1_template.Rmd",
    "project_path" : null,
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_markdown"
}